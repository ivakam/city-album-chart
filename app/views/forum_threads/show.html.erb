<% title @thread.title %>
<% description "varieti.es is an open source archive for city pop. Browse your favorite city pop albums in an accessible way!" %>
<%= image_tag "varietiescropped.png", id: "alt-img" %>
<div id="bg-opacity"></div>
<div id="albums-bg-container">
	<%= image_tag "variety.jpg" %>
	<%= image_tag "mignonne.jpg" %>
	<%= image_tag "niagaratrianglevol2.jpg" %>
	<%= image_tag "superflight.jpg" %>
	<%= image_tag "bigwave.jpg" %>
</div>
<div id="search-title">
	<div id="logo-title">
		<a href="/albums/index"><h1>varieti.es</h1></a>
		<a href="/albums/index" id="beta-title">BETA!</a>
		<h2>City Pop Album Archive</h2>
	</div>
</div>
<div id="main-container">
    <div id="main-opacity"></div>
    <%= render 'partials/navbar_slim' %>
    <%= image_tag "spinner.gif", class: "spinner hidden" %>
    <div id="board-container">
        <div id="forum-opacity"></div>
        <h2 id="title"><%= @thread.category.titleize %> - <%= @thread.title %></h2>
        <div class="page-container">
            <% if @page - 1 > 0 %>
            <a class="icon" href="<%= root_url + "forum/#{@thread.category}/t/#{@thread.id}?p=#{@page - 1}"%>"><ion-icon name="ios-arrow-back"></ion-icon></a>
            <% end %>
            <% (0...(@posts.length / 10.0).ceil).each do | i | %>
            <a class="page-btn <%= tempClass = (i + 1 == @page) ? 'underline' : '' %>" href="<%= root_url + "forum/#{@thread.category}/t/#{@thread.id}?p=#{i + 1}" %>"><%= i + 1 %></a>
            <% end %>
            <% if @page + 1 <= (@posts.length / 10.0).ceil %>
            <a class="icon" href="<%= root_url + "forum/#{@thread.category}/t/#{@thread.id}?p=#{@page + 1}"%>"><ion-icon name="ios-arrow-forward"></ion-icon></a>
            <% end %>
        </div>
        <div id="post-list">
            <ul>
                <div id="forum-opacity" class="darker"></div>
                <% @page_posts.each_with_index do | post, i | %>
                <li>
                    <div class="post-header">
                        <p class="post-index">#<%= i + 1 %></p>
                        <p>Posted at <%= post.created_at %></p>
                        <p>Score: <%= post.score %></p>
                    </div>
                    <div class="post-body">
                        <div class="user-info">
                            <p class="user-name"><b><a href="<%= root_url + 'users/' + post.user.username %>"><%= post.user.username %></a></b></p>
                            <div class="user-badges">
                            <% get_badges(post.user).each do | badge | %>
                            <div class="badge <%= badge.downcase %>"><p><%= badge %></p></div>
                            <% end %>
                            </div>
                            <div class="avatar-wrapper"><a href="<%= root_url + 'users/' + post.user.username %>">
                            <% if post.user.avatar.attached? %>
                            <%= image_tag post.user.avatar.variant(resize: "200x200") %>
                            <% else %>
                            <img src="https://i.imgur.com/ceYNiDi.png"></img>
                            <% end %>
                            </a></div>
                            <p class="user-account-type"><b><%= post.user.account_type %></b></p>
                            <p class="user-karma"><%= post.user.karma %> karma</p>
                            <p class="user-post-count"><%= post.user.posts.length %> posts</p>
                            <p class="user-location"><b>Location:</b> <%= post.user.location %></p>
                        </div>
                        <div class="text-container">
                            <div class="post-text">
                            <p><%= post.body %></p>
                            </div>
                            <div class="user-signature">
                                <p><%= post.user.signature %></p>
                            </div>
                        </div>
                    </div>
                </li>
                <% end %>
            </ul>
        </div>
        <div class="page-container">
            <% if @page - 1 > 0 %>
            <a class="icon" href="<%= root_url + "forum/#{@thread.category}/t/#{@thread.id}?p=#{@page - 1}"%>"><ion-icon name="ios-arrow-back"></ion-icon></a>
            <% end %>
            <% (0...(@posts.length / 10.0).ceil).each do | i | %>
            <a class="page-btn <%= tempClass = (i + 1 == @page) ? 'underline' : '' %>" href="<%= root_url + "forum/#{@thread.category}/t/#{@thread.id}?p=#{i + 1}" %>"><%= i + 1 %></a>
            <% end %>
            <% if @page + 1 <= (@posts.length / 10.0).ceil %>
            <a class="icon" href="<%= root_url + "forum/#{@thread.category}/t/#{@thread.id}?p=#{@page + 1}"%>"><ion-icon name="ios-arrow-forward"></ion-icon></a>
            <% end %>
        </div>
    </div>
</div>